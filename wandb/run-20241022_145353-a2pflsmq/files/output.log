output_dir ./outputs/train_dataset
Lengths of unique contexts : 56737
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at klue/bert-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Lengths of unique contexts : 56737
-----------BM25 pickle loaded.-----------
Lengths of unique contexts : 56737
Loaded 56737 unique contexts
Initializing BM25 model...
-----------BM25 pickle loaded.-----------
Dense retriever does not have get_dense_embedding method. Skipping dense embedding initialization.
Initialized hybrid_1stage with ratio: 0.5
Hybrid retrieve called with ratio: 0.5
  0%|                                                                                                | 0/240 [00:00<?, ?it/s]
Query: 처음으로 부실 경영인에 대한 보상 선고를 받은 회사는?
Traceback (most recent call last):
  File "/data/ephemeral/home/ksw/level2-mrc-nlp-01/src/main.py", line 486, in <module>
    main()
  File "/data/ephemeral/home/ksw/level2-mrc-nlp-01/src/main.py", line 483, in main
    do_retrieval(config, training_args, logger, is_testing)
  File "/data/ephemeral/home/ksw/level2-mrc-nlp-01/src/main.py", line 393, in do_retrieval
    df = retriever.retrieve(validation_dataset, topk=k)
  File "/data/ephemeral/home/ksw/level2-mrc-nlp-01/src/Retrieval/hybrid_1stage.py", line 70, in retrieve
    return self.retrieve_multi(query_or_dataset, topk=topk)
  File "/data/ephemeral/home/ksw/level2-mrc-nlp-01/src/Retrieval/hybrid_1stage.py", line 102, in retrieve_multi
    scores, indices = self.retrieve_single(question, topk)
  File "/data/ephemeral/home/ksw/level2-mrc-nlp-01/src/Retrieval/hybrid_1stage.py", line 80, in retrieve_single
    dense_scores, dense_indices = self.dense_retriever.get_relevant_doc(query, topk)
  File "/data/ephemeral/home/ksw/level2-mrc-nlp-01/src/Retrieval/cross_encoder.py", line 245, in get_relevant_doc
    questions = [query] * len(contexts)
TypeError: object of type 'int' has no len()
